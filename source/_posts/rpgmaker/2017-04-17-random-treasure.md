title: ランダムにアイテムを取得するプラグイン(MV版)
date: 2017-04-17
category: RPGツクールMV
---

この記事はMV版です。VXAce版は[こちら](/rpgmaker/2018-08-03-random-treasure-vxace)

らんだむダンジョンがすごい好きで周回要素ないのに50時間ぐらいかかるのを2週プレイした。
らんだむダンジョンはランダムにアイテムが手に入る宝箱がある。今回はそれを実装した。
ツクールのデフォルトの機能でも実現できるけど、結構面倒くさいので、簡単にできるプラグインを作る。

![ランダムに手に入る宝箱](/img/2017-04-17-random-treasure/random-get.gif)


こういう仕様にしたい。

1. ランダムに手に入るアイテム群を設定できる（ダンジョンごとに異なるアイテム群を設定できる）
2. アイテムごとに異なる確率を設定できる
3. できるだけ設定しやすく、1と2を実現する

## ランダムに手に入るアイテム群を設定できる

アイテム選択があるコマンドを乗っ取ることにした。ショップコマンドだ。
ショップコマンドはアイテムをGUIで選択できるので設定しやすくて良い。

![ショップコマンド](/img/2017-04-17-random-treasure/shop.png)

## アイテムごとに異なる確率を設定できる

レアなアイテムは出にくくしたい。ショップコマンドはアイテムごとに価格を設定できる。
ちょうどいいので、この価格を確率にしてしまおう。
くじの本数だと考えてほしい。例えば、アイテムが3つあって、アイテム1=10、アイテム2=10、アイテム3=1だったとする。
こうすれば、くじの本数が1本しかないアイテム3は出にくくなる。

![確率](/img/2017-04-17-random-treasure/rate.png)

![確率一覧](/img/2017-04-17-random-treasure/ratelist.png)

## 導入方法

まず、プラグインが[これ](https://raw.githubusercontent.com/kido0617/rpgmakerMV-plugin/master/RandomTreasure/RandomTreasure.js)。
導入したら、まずプラグインコマンドで `RandomTreasure reset` を実行する。
このコマンド直後のショップ処理で登録したアイテムがランダムに手に入るアイテム群となる。ショップは開かれない。

![設定プラグインコマンド](/img/2017-04-17-random-treasure/plugin-command1.png)

そして、次に宝箱側の設定だ。プラグインコマンドで `RandomTreasure get` を実行するとランダムに1個手に入る。

## 入手したアイテムの表示方法

プラグインパラメータにアイテム名格納変数とアイテムアイコン番号格納変数を用意した。
ここに変数番号を入れておくと、その番号の変数にアイテム名とアイコン番号が自動的に入る。
![パラメータ](/img/2017-04-17-random-treasure/param.png)
なので、これを使って、メッセージウィンドウに以下のように入力すれば入手したアイテムとアイコンが表示できる。
(変数番号はパラメータで指定した値)
```
\I[\V[20]] \V[10]を手に入れた
```

![ランダムに取得](/img/2017-04-17-random-treasure/get.png)

※ 2017/12/09 入手インフォメーション系プラグイン(TinyGetInfoWnd.jsやGetInformation.js)に対応しました。

## レア度に応じた演出

プラグインパラメータにアイテムのくじの本数格納変数を用意した。
ここに変数番号を入れておくと、その番号に手に入れたアイテムのくじの本数が入る。
レア度に応じた演出をしたい場合、この変数を分岐にして演出を行えば良い

## DL先

<https://raw.githubusercontent.com/kido0617/rpgmakerMV-plugin/master/RandomTreasure/RandomTreasure.js>


## ライセンス

Released under the MIT license